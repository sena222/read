{"ast":null,"code":"var _jsxFileName = \"/home/parallels/Downloads/react-epub-viewer-demo/src/react-viewer/modules/epubViewer/EpubViewer.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Book } from 'epubjs';\n// style\nimport styles from '../../modules/epubViewer/styles';\n// types\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n/**\n * EpubViewer Module\n * @class\n * @param props\n * @param props.url Epub path\n * @param props.epubFileOptions Epub file option\n * @param props.epubOptions Epub viewer option\n * @param props.style Epub Wrapper style\n * @param props.location Epub CFI or href\n * @param props.bookChanged Run when book changed\n * @param props.rendtionChanged Run when rendition changed\n * @param props.pageChanged Run when page changed\n * @param props.tocChanged Run when toc changed\n * @param props.selectionChanged Run when selected\n * @param props.loadingView Loading Component\n * @param ref Viewer ref\n */\nconst EpubViewer = (_ref, ref) => {\n  _s();\n  let {\n    url,\n    epubFileOptions,\n    epubOptions,\n    style,\n    location,\n    bookChanged,\n    rendtionChanged,\n    pageChanged,\n    tocChanged,\n    selectionChanged,\n    loadingView\n  } = _ref;\n  // TODO Fix the ref type correctly instead 'any' type.\n  const viewerStyle = style ? {\n    ...styles,\n    ...style\n  } : styles;\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [book, setBook] = useState(null);\n  const [rendition, setRendition] = useState(null);\n  const currentCfi = useRef('');\n\n  /**\n   * Move page\n   * @method\n   * @param type direction\n   */\n  const movePage = useCallback(type => {\n    if (!rendition) return;\n    if (type === 'PREV') rendition.prev();else rendition.next();\n  }, [rendition]);\n\n  /**\n   * Move page by arrow key\n   * @method\n   * @param props Keyboard Event\n   * @param props.key\n   */\n  const handleKeyPress = useCallback(_ref2 => {\n    let {\n      key\n    } = _ref2;\n    key && key === 'ArrowLeft' && movePage('PREV');\n    key && key === 'ArrowRight' && movePage('NEXT');\n  }, [movePage]);\n\n  /**\n   * Run when location changed\n   * @method\n   * @param loc\n   * - Set location state\n   * - Run 'locationChanged()' through startCFI\n   */\n  const onLocationChange = useCallback(loc => {\n    const startCfi = loc && loc.start;\n    const endCfi = loc && loc.end;\n    const base = loc && loc.start.slice(8).split('!')[0];\n    if (!book) return;\n    const spineItem = book.spine.get(startCfi);\n    const navItem = book.navigation.get(spineItem.href);\n    const chapterName = navItem && navItem.label.trim();\n    const locations = book.locations;\n    const currentPage = locations.locationFromCfi(startCfi);\n    const totalPage = locations.total;\n    pageChanged && pageChanged({\n      chapterName,\n      currentPage,\n      totalPage,\n      startCfi,\n      endCfi,\n      base\n    });\n    currentCfi.current = startCfi;\n  }, [book, pageChanged]);\n\n  /**\n   * Highlight function\n   * @param cfiRange Selected CFIRange\n   * @param callback Highlight callback function when click it\n   * @param color Highlight color\n   */\n  const onHighlight = useCallback((cfiRange, callback, color) => {\n    if (!rendition) return;\n    rendition.annotations.remove(cfiRange, 'highlight');\n    rendition.annotations.highlight(cfiRange, {}, callback, 'epub-highlight', {\n      fill: color || '#fdf183'\n    });\n  }, [rendition]);\n\n  /**\n   * Highlight remove function\n   * @param cfiRange Selected CFIRange\n   */\n  const onRemoveHighlight = useCallback(cfiRange => {\n    if (!rendition) return;\n    rendition.annotations.remove(cfiRange, 'highlight');\n  }, [rendition]);\n\n  /**\n   * Register viewer control function\n   * @method\n   * - REF.CURRENT.prevPage() : Move prev page\n   * - REF.CURRENT.nextPage() : Move next page\n   * - REF.CURRENT.getCurrentCfi() : Get current CFI\n   * - REF.CURRENT.onHighlight(): Set highlight\n   * - REF.CURRENT.offHighlight(): Remove specific highliht\n   * - REF.CURRENT.seLocation(): Move to specific cfi or href\n   */\n  const registerGlobalFunc = useCallback(() => {\n    if (!ref.current) return;\n    if (movePage) {\n      ref.current.prevPage = () => movePage('PREV');\n      ref.current.nextPage = () => movePage('NEXT');\n    }\n    ref.current.getCurrentCfi = () => currentCfi.current;\n    if (onHighlight) {\n      ref.current.onHighlight = onHighlight;\n    }\n    if (onRemoveHighlight) {\n      ref.current.offHighlight = onRemoveHighlight;\n    }\n    if (rendition) {\n      ref.current.setLocation = location => rendition.display(location);\n    }\n  }, [ref, rendition, movePage, onHighlight, onRemoveHighlight]);\n\n  /** Ref Checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error('[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.');\n    }\n  }, [ref]);\n\n  /** Epub init options Changed */\n  useEffect(() => {\n    if (!url) return;\n    let mounted = true;\n    let book_ = null;\n    if (!mounted) return;\n    if (book_) {\n      book_.destroy();\n    }\n    book_ = new Book(url, epubFileOptions);\n    setBook(book_);\n    return () => {\n      mounted = false;\n    };\n  }, [url, epubFileOptions, setBook, setIsLoaded]);\n\n  /** Book Changed */\n  useEffect(() => {\n    if (!book) return;\n    if (bookChanged) bookChanged(book);\n    book.loaded.navigation.then(_ref3 => {\n      let {\n        toc\n      } = _ref3;\n      const toc_ = toc.map(t => ({\n        label: t.label,\n        href: t.href\n      }));\n      setIsLoaded(true);\n      if (tocChanged) tocChanged(toc_);\n    });\n    book.ready.then(function () {\n      if (!book) return;\n      const stored = localStorage.getItem(book.key() + '-locations');\n      if (stored) {\n        return book.locations.load(stored);\n      } else {\n        return book.locations.generate(1024);\n      }\n    }).then(() => {\n      if (!book) return;\n      localStorage.setItem(book.key() + '-locations', book.locations.save());\n    });\n  }, [book, bookChanged, tocChanged]);\n\n  /** Rendition Changed */\n  useEffect(() => {\n    if (!rendition) return;\n    if (rendtionChanged) rendtionChanged(rendition);\n  }, [rendition, rendtionChanged]);\n\n  /** Viewer Option Changed */\n  useEffect(() => {\n    let mounted = true;\n    if (!book) return;\n    const node = ref.current;\n    if (!node) return;\n    node.innerHTML = '';\n    book.ready.then(function () {\n      if (!mounted) return;\n      if (book.spine) {\n        var _book$rendition, _book$rendition$locat, _book$rendition$locat2;\n        const loc = (_book$rendition = book.rendition) === null || _book$rendition === void 0 ? void 0 : (_book$rendition$locat = _book$rendition.location) === null || _book$rendition$locat === void 0 ? void 0 : (_book$rendition$locat2 = _book$rendition$locat.start) === null || _book$rendition$locat2 === void 0 ? void 0 : _book$rendition$locat2.cfi;\n\n        // if (book.rendition) book.rendition.destroy();\n\n        const rendition_ = book.renderTo(node, {\n          width: '100%',\n          height: '100%',\n          ...epubOptions\n        });\n        setRendition(rendition_);\n        if (loc) {\n          rendition_.display(loc);\n        } else {\n          rendition_.display();\n        }\n      }\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [ref, book, epubOptions, style, setRendition]);\n\n  /** Location Changed */\n  useEffect(() => {\n    if (!ref.current || !location) return;\n    if (ref.current.setLocation) ref.current.setLocation(location);\n  }, [ref, location]);\n\n  /**\n   * Emit Viewer Event\n   * - Register move event\n   * - Register location changed event\n   * - Register selection event\n   */\n  /* eslint-disable */\n  useEffect(() => {\n    if (!rendition) return;\n\n    // Emit global control function\n    registerGlobalFunc();\n    document.addEventListener('keyup', handleKeyPress, false);\n    rendition.on('keyup', handleKeyPress);\n    rendition.on('locationChanged', onLocationChange);\n    selectionChanged && rendition.on('selected', selectionChanged);\n    return () => {\n      document.removeEventListener('keyup', handleKeyPress, false);\n      rendition.off('keyup', handleKeyPress);\n      rendition.off('locationChanged', onLocationChange);\n      selectionChanged && rendition.off('selected', selectionChanged);\n    };\n  }, [rendition, registerGlobalFunc, handleKeyPress]);\n  /* eslint-enable */\n\n  const openBook = e => {\n    const node = ref.current;\n    if (!node) return;\n    node.innerHTML = '';\n    console.log('open');\n\n    // @ts-ignore\n    book.open(e.target.result, 'binary');\n    // @ts-ignore\n    setRendition(book === null || book === void 0 ? void 0 : book.renderTo(node, {\n      width: '100%',\n      height: '100%',\n      ...epubOptions\n    }));\n\n    // @ts-ignore\n    rendition.display();\n  };\n  var inputElement = document.getElementById(\"input\");\n  inputElement === null || inputElement === void 0 ? void 0 : inputElement.addEventListener('change', function (e) {\n    var _e$target;\n    // @ts-ignore\n    var file = e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.files[0];\n    console.log(file, 'file');\n    if (window.FileReader) {\n      var reader = new FileReader();\n      reader.onload = openBook;\n      reader.readAsArrayBuffer(file);\n    }\n    console.log('file', file);\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      id: \"input\",\n      type: \"file\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 6\n    }, this), \"wdwd\", !isLoaded && loadingView, /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: ref,\n      style: viewerStyle\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(EpubViewer, \"o4qb5kjMVYLYYaH6Xzbq+YkeP1Q=\");\n_c = EpubViewer;\nexport default _c2 = /*#__PURE__*/React.forwardRef(EpubViewer);\nvar _c, _c2;\n$RefreshReg$(_c, \"EpubViewer\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","Book","styles","EpubViewer","ref","url","epubFileOptions","epubOptions","style","location","bookChanged","rendtionChanged","pageChanged","tocChanged","selectionChanged","loadingView","viewerStyle","isLoaded","setIsLoaded","book","setBook","rendition","setRendition","currentCfi","movePage","type","prev","next","handleKeyPress","key","onLocationChange","loc","startCfi","start","endCfi","end","base","slice","split","spineItem","spine","get","navItem","navigation","href","chapterName","label","trim","locations","currentPage","locationFromCfi","totalPage","total","current","onHighlight","cfiRange","callback","color","annotations","remove","highlight","fill","onRemoveHighlight","registerGlobalFunc","prevPage","nextPage","getCurrentCfi","offHighlight","setLocation","display","Error","mounted","book_","destroy","loaded","then","toc","toc_","map","t","ready","stored","localStorage","getItem","load","generate","setItem","save","node","innerHTML","cfi","rendition_","renderTo","width","height","document","addEventListener","on","removeEventListener","off","openBook","e","console","log","open","target","result","inputElement","getElementById","file","files","window","FileReader","reader","onload","readAsArrayBuffer","forwardRef"],"sources":["/home/parallels/Downloads/react-epub-viewer-demo/src/react-viewer/modules/epubViewer/EpubViewer.tsx"],"sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  CSSProperties,\n} from 'react';\nimport { Book, Rendition } from 'epubjs';\n// style\nimport styles from '../../modules/epubViewer/styles';\n// types\nimport { EpubViewerProps, ViewerRef } from 'types';\nimport Toc from 'types/toc';\nimport Loc from 'types/loc';\n\n/**\n * EpubViewer Module\n * @class\n * @param props\n * @param props.url Epub path\n * @param props.epubFileOptions Epub file option\n * @param props.epubOptions Epub viewer option\n * @param props.style Epub Wrapper style\n * @param props.location Epub CFI or href\n * @param props.bookChanged Run when book changed\n * @param props.rendtionChanged Run when rendition changed\n * @param props.pageChanged Run when page changed\n * @param props.tocChanged Run when toc changed\n * @param props.selectionChanged Run when selected\n * @param props.loadingView Loading Component\n * @param ref Viewer ref\n */\nconst EpubViewer = (\n  {\n    url,\n    epubFileOptions,\n    epubOptions,\n    style,\n    location,\n    bookChanged,\n    rendtionChanged,\n    pageChanged,\n    tocChanged,\n    selectionChanged,\n    loadingView,\n  }: EpubViewerProps,\n  ref: React.RefObject<ViewerRef> | any,\n) => {\n  // TODO Fix the ref type correctly instead 'any' type.\n  const viewerStyle: CSSProperties = style ? { ...styles, ...style } : styles;\n\n  const [isLoaded, setIsLoaded] = useState(false);\n\n  const [book, setBook] = useState<Book | null>(null);\n\n  const [rendition, setRendition] = useState<Rendition | null>(null);\n\n  const currentCfi = useRef<string>('');\n\n  /**\n   * Move page\n   * @method\n   * @param type direction\n   */\n  const movePage = useCallback(\n    (type: 'PREV' | 'NEXT') => {\n      if (!rendition) return;\n      if (type === 'PREV') rendition.prev();\n      else rendition.next();\n    },\n    [rendition],\n  );\n\n  /**\n   * Move page by arrow key\n   * @method\n   * @param props Keyboard Event\n   * @param props.key\n   */\n  const handleKeyPress = useCallback(\n    ({ key }: any) => {\n      key && key === 'ArrowLeft' && movePage('PREV');\n      key && key === 'ArrowRight' && movePage('NEXT');\n    },\n    [movePage],\n  );\n\n  /**\n   * Run when location changed\n   * @method\n   * @param loc\n   * - Set location state\n   * - Run 'locationChanged()' through startCFI\n   */\n  const onLocationChange = useCallback(\n    (loc: Loc) => {\n      const startCfi = loc && loc.start;\n      const endCfi = loc && loc.end;\n      const base = loc && loc.start.slice(8).split('!')[0];\n\n      if (!book) return;\n\n      const spineItem = book.spine.get(startCfi);\n      const navItem = book.navigation.get(spineItem.href);\n      const chapterName = navItem && navItem.label.trim();\n\n      const locations: any = book.locations;\n      const currentPage = locations.locationFromCfi(startCfi);\n      const totalPage = locations.total;\n\n      pageChanged &&\n        pageChanged({\n          chapterName,\n          currentPage,\n          totalPage,\n          startCfi,\n          endCfi,\n          base,\n        });\n\n      currentCfi.current = startCfi;\n    },\n    [book, pageChanged],\n  );\n\n  /**\n   * Highlight function\n   * @param cfiRange Selected CFIRange\n   * @param callback Highlight callback function when click it\n   * @param color Highlight color\n   */\n  const onHighlight = useCallback(\n    (cfiRange: string, callback?: (e: any) => void, color?: string) => {\n      if (!rendition) return;\n\n      rendition.annotations.remove(cfiRange, 'highlight');\n      rendition.annotations.highlight(\n        cfiRange,\n        {},\n        callback,\n        'epub-highlight',\n        {\n          fill: color || '#fdf183',\n        },\n      );\n    },\n    [rendition],\n  );\n\n  /**\n   * Highlight remove function\n   * @param cfiRange Selected CFIRange\n   */\n  const onRemoveHighlight = useCallback(\n    (cfiRange: string) => {\n      if (!rendition) return;\n\n      rendition.annotations.remove(cfiRange, 'highlight');\n    },\n    [rendition],\n  );\n\n  /**\n   * Register viewer control function\n   * @method\n   * - REF.CURRENT.prevPage() : Move prev page\n   * - REF.CURRENT.nextPage() : Move next page\n   * - REF.CURRENT.getCurrentCfi() : Get current CFI\n   * - REF.CURRENT.onHighlight(): Set highlight\n   * - REF.CURRENT.offHighlight(): Remove specific highliht\n   * - REF.CURRENT.seLocation(): Move to specific cfi or href\n   */\n  const registerGlobalFunc = useCallback(() => {\n    if (!ref.current) return;\n    if (movePage) {\n      ref.current.prevPage = () => movePage('PREV');\n      ref.current.nextPage = () => movePage('NEXT');\n    }\n    ref.current.getCurrentCfi = () => currentCfi.current;\n    if (onHighlight) {\n      ref.current.onHighlight = onHighlight;\n    }\n    if (onRemoveHighlight) {\n      ref.current.offHighlight = onRemoveHighlight;\n    }\n    if (rendition) {\n      ref.current.setLocation = (location: string) =>\n        rendition.display(location);\n    }\n  }, [ref, rendition, movePage, onHighlight, onRemoveHighlight]);\n\n  /** Ref Checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error(\n        '[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.',\n      );\n    }\n  }, [ref]);\n\n  /** Epub init options Changed */\n  useEffect(() => {\n    if (!url) return;\n\n    let mounted: boolean = true;\n    let book_: Book | any = null;\n\n    if (!mounted) return;\n\n    if (book_) {\n      book_.destroy();\n    }\n\n    book_ = new Book(url, epubFileOptions);\n    setBook(book_);\n\n    return () => {\n      mounted = false;\n    };\n  }, [url, epubFileOptions, setBook, setIsLoaded]);\n\n  /** Book Changed */\n  useEffect(() => {\n    if (!book) return;\n\n    if (bookChanged) bookChanged(book);\n\n    book.loaded.navigation.then(({ toc }) => {\n      const toc_: Toc[] = toc.map(t => ({\n        label: t.label,\n        href: t.href,\n      }));\n\n      setIsLoaded(true);\n      if (tocChanged) tocChanged(toc_);\n    });\n\n    book.ready\n      .then(function () {\n        if (!book) return;\n\n        const stored = localStorage.getItem(book.key() + '-locations');\n        if (stored) {\n          return book.locations.load(stored);\n        } else {\n          return book.locations.generate(1024);\n        }\n      })\n      .then(() => {\n        if (!book) return;\n        localStorage.setItem(book.key() + '-locations', book.locations.save());\n      });\n  }, [book, bookChanged, tocChanged]);\n\n  /** Rendition Changed */\n  useEffect(() => {\n    if (!rendition) return;\n\n    if (rendtionChanged) rendtionChanged(rendition);\n  }, [rendition, rendtionChanged]);\n\n  /** Viewer Option Changed */\n  useEffect(() => {\n    let mounted = true;\n    if (!book) return;\n\n    const node = ref.current;\n    if (!node) return;\n    node.innerHTML = '';\n\n    book.ready.then(function () {\n      if (!mounted) return;\n\n      if (book.spine) {\n        const loc = book.rendition?.location?.start?.cfi;\n\n        // if (book.rendition) book.rendition.destroy();\n\n        const rendition_ = book.renderTo(node, {\n          width: '100%',\n          height: '100%',\n          ...epubOptions,\n        });\n        setRendition(rendition_);\n\n        if (loc) {\n          rendition_.display(loc);\n        } else {\n          rendition_.display();\n        }\n      }\n    });\n\n    return () => {\n      mounted = false;\n    };\n  }, [ref, book, epubOptions, style, setRendition]);\n\n  /** Location Changed */\n  useEffect(() => {\n    if (!ref.current || !location) return;\n    if (ref.current.setLocation) ref.current.setLocation(location);\n  }, [ref, location]);\n\n  /**\n   * Emit Viewer Event\n   * - Register move event\n   * - Register location changed event\n   * - Register selection event\n   */\n  /* eslint-disable */\n  useEffect(() => {\n    if (!rendition) return;\n\n    // Emit global control function\n    registerGlobalFunc();\n\n    document.addEventListener('keyup', handleKeyPress, false);\n    rendition.on('keyup', handleKeyPress);\n    rendition.on('locationChanged', onLocationChange);\n    selectionChanged && rendition.on('selected', selectionChanged);\n\n    return () => {\n      document.removeEventListener('keyup', handleKeyPress, false);\n      rendition.off('keyup', handleKeyPress);\n      rendition.off('locationChanged', onLocationChange);\n      selectionChanged && rendition.off('selected', selectionChanged);\n    };\n  }, [rendition, registerGlobalFunc, handleKeyPress]);\n  /* eslint-enable */\n\n  const openBook = (e: any) => {\n      const node = ref.current;\n    if (!node) return;\n    node.innerHTML = '';\n    console.log('open')\n\n\t// @ts-ignore\n\tbook.open(e.target.result, 'binary')\n  // @ts-ignore\n    setRendition(book?.renderTo(node, {\n          width: '100%',\n          height: '100%',\n          ...epubOptions,\n        }))\n\n        // @ts-ignore\n    rendition.display()\n}\n\nvar inputElement = document.getElementById(\"input\");\ninputElement?.addEventListener('change', function (e) {\n    // @ts-ignore\n        var file = e?.target?.files[0];\n        console.log(file, 'file')\n        if (window.FileReader) {\n            var reader = new FileReader();\n            reader.onload = openBook;\n            reader.readAsArrayBuffer(file);\n        }\n\t\t\n\t\t\n        console.log('file', file)\n    });\n\n\n\n  return (\n    <>\n     <input id='input' type='file' />\n     wdwd\n      {!isLoaded && loadingView}\n      <div ref={ref} style={viewerStyle} />\n    </>\n  );\n};\n\nexport default React.forwardRef(EpubViewer);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}