{"ast":null,"code":"import _objectSpread from\"/home/parallels/Downloads/read/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useDispatch}from'react-redux';// components\nimport Wrapper from'components/note/highlight/Wrapper';import Title from'components/note/highlight/Title';import Post from'components/note/highlight/Post';// slices\nimport{updateHighlight}from'slices/book';// utils\nimport{cfiRangeSpliter}from'lib/utils/commonUtil';// types\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Highlight=function Highlight(_ref){var highlight=_ref.highlight,onClick=_ref.onClick,emitEvent=_ref.emitEvent,viewerRef=_ref.viewerRef;var dispatch=useDispatch();/** 하이라이트 클릭 */var onClickHighlight=function onClickHighlight(){if(!viewerRef.current)return;var now=new Date().toISOString();dispatch(updateHighlight(_objectSpread(_objectSpread({},highlight),{},{accessTime:now})));var splitCfi=cfiRangeSpliter(highlight.cfiRange);if(!splitCfi)return;var startCfi=splitCfi.startCfi;viewerRef.current.setLocation(startCfi);emitEvent();var svgContainer=viewerRef.current.querySelector(\"svg\");if(!svgContainer)return;var targetSvg=svgContainer.querySelector(\"g[data-epubcfi=\\\"\".concat(highlight.cfiRange,\"\\\"]\"));if(!targetSvg)return;onClick(targetSvg.childNodes[0]);};return/*#__PURE__*/_jsx(Wrapper,{onClick:onClickHighlight,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Title,{children:highlight.chpaterName}),/*#__PURE__*/_jsx(Post,{color:highlight.color,children:highlight.content})]})});};export default Highlight;","map":{"version":3,"names":["useDispatch","Wrapper","Title","Post","updateHighlight","cfiRangeSpliter","Highlight","highlight","onClick","emitEvent","viewerRef","dispatch","onClickHighlight","current","now","Date","toISOString","accessTime","splitCfi","cfiRange","startCfi","setLocation","svgContainer","querySelector","targetSvg","childNodes","chpaterName","color","content"],"sources":["/home/parallels/Downloads/read/src/containers/menu/commons/Highlight.tsx"],"sourcesContent":["import { useDispatch } from 'react-redux'\n// components\nimport Wrapper from 'components/note/highlight/Wrapper'\nimport Title from 'components/note/highlight/Title'\nimport Post from 'components/note/highlight/Post'\n// slices\nimport { updateHighlight } from 'slices/book'\n// utils\nimport { cfiRangeSpliter } from 'lib/utils/commonUtil'\n// types\nimport HighlightType from 'types/highlight'\n\nconst Highlight = ({ \n  highlight, \n  onClick, \n  emitEvent, \n  viewerRef\n}: Props) => {\n  const dispatch = useDispatch();\n\n\n  /** 하이라이트 클릭 */\n  const onClickHighlight = () => {\n    if (!viewerRef.current) return;\n    \n    const now = new Date().toISOString();\n    dispatch(updateHighlight({\n      ...highlight,\n      accessTime: now\n    }));\n\n    const splitCfi = cfiRangeSpliter(highlight.cfiRange);\n    if (!splitCfi) return;\n\n    const { startCfi } = splitCfi;\n\n    viewerRef.current.setLocation(startCfi);\n\n    emitEvent();\n\n    const svgContainer = viewerRef.current.querySelector(\"svg\");\n    if (!svgContainer) return;\n\n    const targetSvg = svgContainer.querySelector(`g[data-epubcfi=\"${highlight.cfiRange}\"]`);\n    if (!targetSvg) return;\n\n    onClick(targetSvg.childNodes[0]);\n  }\n  \n  return (\n    <Wrapper onClick={onClickHighlight}>\n      <div>\n        <Title>{highlight.chpaterName}</Title>\n\n        <Post color={highlight.color}>{highlight.content}</Post>\n      </div>\n    </Wrapper>\n  );\n}\n\ninterface Props {\n  highlight: HighlightType;\n  onClick: (highlightNode: any) => void;\n  emitEvent: () => void;\n  viewerRef: any;\n}\n\nexport default Highlight"],"mappings":"mHAAA,OAASA,WAAW,KAAQ,aAAa,CACzC;AACA,MAAOC,QAAO,KAAM,mCAAmC,CACvD,MAAOC,MAAK,KAAM,iCAAiC,CACnD,MAAOC,KAAI,KAAM,gCAAgC,CACjD;AACA,OAASC,eAAe,KAAQ,aAAa,CAC7C;AACA,OAASC,eAAe,KAAQ,sBAAsB,CACtD;AAAA,wFAGA,GAAMC,UAAS,CAAG,QAAZA,UAAS,MAKF,IAJXC,UAAS,MAATA,SAAS,CACTC,OAAO,MAAPA,OAAO,CACPC,SAAS,MAATA,SAAS,CACTC,SAAS,MAATA,SAAS,CAET,GAAMC,SAAQ,CAAGX,WAAW,EAAE,CAG9B,eACA,GAAMY,iBAAgB,CAAG,QAAnBA,iBAAgB,EAAS,CAC7B,GAAI,CAACF,SAAS,CAACG,OAAO,CAAE,OAExB,GAAMC,IAAG,CAAG,GAAIC,KAAI,EAAE,CAACC,WAAW,EAAE,CACpCL,QAAQ,CAACP,eAAe,gCACnBG,SAAS,MACZU,UAAU,CAAEH,GAAG,GACf,CAAC,CAEH,GAAMI,SAAQ,CAAGb,eAAe,CAACE,SAAS,CAACY,QAAQ,CAAC,CACpD,GAAI,CAACD,QAAQ,CAAE,OAEf,GAAQE,SAAQ,CAAKF,QAAQ,CAArBE,QAAQ,CAEhBV,SAAS,CAACG,OAAO,CAACQ,WAAW,CAACD,QAAQ,CAAC,CAEvCX,SAAS,EAAE,CAEX,GAAMa,aAAY,CAAGZ,SAAS,CAACG,OAAO,CAACU,aAAa,CAAC,KAAK,CAAC,CAC3D,GAAI,CAACD,YAAY,CAAE,OAEnB,GAAME,UAAS,CAAGF,YAAY,CAACC,aAAa,4BAAoBhB,SAAS,CAACY,QAAQ,QAAK,CACvF,GAAI,CAACK,SAAS,CAAE,OAEhBhB,OAAO,CAACgB,SAAS,CAACC,UAAU,CAAC,CAAC,CAAC,CAAC,CAClC,CAAC,CAED,mBACE,KAAC,OAAO,EAAC,OAAO,CAAEb,gBAAiB,uBACjC,oCACE,KAAC,KAAK,WAAEL,SAAS,CAACmB,WAAW,EAAS,cAEtC,KAAC,IAAI,EAAC,KAAK,CAAEnB,SAAS,CAACoB,KAAM,UAAEpB,SAAS,CAACqB,OAAO,EAAQ,GACpD,EACE,CAEd,CAAC,CASD,cAAetB,UAAS"},"metadata":{},"sourceType":"module"}