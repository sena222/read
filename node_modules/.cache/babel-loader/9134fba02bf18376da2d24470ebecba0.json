{"ast":null,"code":"var _jsxFileName = \"/home/parallels/Downloads/react-epub-viewer-demo/src/react-viewer/modules/reactViewer/ReactViewer.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\n// modules\nimport EpubViewer from '../../modules/epubViewer/EpubViewer';\n// components\nimport LoadingView from 'LoadingView';\n// utils\nimport { debounce, timeFormatter } from 'lib/utils/commonUtil';\n// styles\nimport viewerDefaultStyles from '../../modules/reactViewer/viewerStyle';\n// types\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n/**\n * Epub React Viewer Module\n * @class\n * @param props\n * @param props.url Epub file path\n * @param props.viewerLayout Viewer layout\n * @param props.viewerStyle Viewer style\n * @param props.viewerStyleURL Viwer style - CSS URL\n * @param props.viewerOption Viewer option\n * @param props.onBookInfoChange Run when book information changed\n * @param props.onPageChange Run when page changed\n * @param props.onTocChange Run when toc changed\n * @param props.onSelection Run when selected\n * @param props.loadingView Loading component\n * @param ref Viewer ref\n */\nconst ReactViewer = (_ref, ref) => {\n  _s();\n  let {\n    url,\n    viewerLayout,\n    viewerStyle,\n    viewerStyleURL,\n    viewerOption,\n    onBookInfoChange,\n    onPageChange,\n    onTocChange,\n    onSelection,\n    loadingView\n  } = _ref;\n  // TODO Fix the ref type correctly instead 'any' type.\n  const [book, setBook] = useState(null);\n  const [rendition, setRendition] = useState(null);\n  const [layoutStyle, setLayoutStyle] = useState({});\n  const [bookStyle, setBookStyle] = useState({\n    fontFamily: 'Origin',\n    fontSize: 16,\n    lineHeight: 1.4,\n    marginHorizontal: 0,\n    marginVertical: 0\n  });\n  const [bookOption, setBookOption] = useState({\n    flow: 'paginated',\n    resizeOnOrientationChange: true,\n    spread: 'auto'\n  });\n  const currentSelection = useRef({\n    cfiRange: '',\n    contents: null\n  });\n\n  /**\n   * Run book changed\n   * @method\n   * @param book Epub Book\n   */\n  const bookChanged = book => setBook(book);\n\n  /**\n   * Run rendition changed\n   * @method\n   * @param rendition Epub Rendition\n   */\n  const rendtionChanged = rendition => setRendition(rendition);\n\n  /**\n   * Run selection changed [Debounce]\n   * @method\n   * @param cfiRange CFIRange\n   * @param contents Selection Epub Contents\n   */\n  const selectionChanged = (cfiRange, contents) => {\n    currentSelection.current = {\n      cfiRange,\n      contents\n    };\n  };\n\n  /**\n   * Viewer resizing function\n   * @method\n   */\n  const onResize = useMemo(() => debounce(250, () => {\n    if (!rendition) return;\n    const viewerLayout_ = viewerLayout || {\n      MIN_VIEWER_WIDTH: 600,\n      MIN_VIEWER_HEIGHT: 300,\n      VIEWER_HEADER_HEIGHT: 0,\n      VIEWER_FOOTER_HEIGHT: 0,\n      VIEWER_SIDEMENU_WIDTH: 0\n    };\n    const {\n      innerWidth: win_w,\n      innerHeight: win_h\n    } = window;\n    const componentHeight = viewerLayout_.VIEWER_HEADER_HEIGHT + viewerLayout_.VIEWER_FOOTER_HEIGHT;\n    const w = win_w - ~~((win_w - viewerLayout_.MIN_VIEWER_WIDTH) / 100 * bookStyle.marginHorizontal);\n    const h = bookOption.flow === 'scrolled-doc' ? win_h - componentHeight : win_h - componentHeight - ~~((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) / 100 * bookStyle.marginVertical);\n    const marginVertical = bookOption.flow === 'scrolled-doc' ? '' : `${~~((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) / 100 * bookStyle.marginVertical) / 2}px`;\n    setLayoutStyle(layout => {\n      if (layout.width !== w || layout.height !== h || layout.marginTop !== marginVertical) {\n        return {\n          ...layout,\n          width: w,\n          height: h,\n          marginTop: marginVertical,\n          marginBottom: marginVertical\n        };\n      }\n      return layout;\n    });\n    try {\n      rendition.resize(w, h);\n    } catch {}\n  }), [rendition, viewerLayout, bookStyle.marginHorizontal, bookStyle.marginVertical, bookOption.flow]);\n\n  /**\n   * Selection Event, run when run mouseup event\n   * @method <br/>\n   * - Fire after the Epubjs selected event. [about 300ms]\n   */\n  const onSelected = useCallback(async () => {\n    if (!ref.current) return;\n    const iframe = ref.current.querySelector('iframe');\n    if (!iframe) return;\n    const iframeWin = iframe.contentWindow;\n    if (!iframeWin) return;\n    const selection_ = iframeWin.getSelection();\n    if (!selection_) return;\n    const selectionText = selection_.toString();\n    if (selectionText === '') return;\n    const cfiRange = await new Promise(resolve => setTimeout(() => resolve(currentSelection.current.cfiRange), 350));\n    if (!cfiRange) return;\n    const contents = currentSelection.current.contents;\n    if (!contents) return;\n    onSelection && onSelection(cfiRange, contents);\n  }, [ref, onSelection]);\n\n  /** Ref checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error('[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.');\n    }\n  }, [ref]);\n\n  /** Epub parsing */\n  // TODO Fix the infinite re-rendering issue, when inlcude `onBookInfoChange` to dependencies array.\n  /* eslint-disable */\n  useEffect(() => {\n    if (!book) return;\n    Promise.all([book.loaded.metadata, book.opened]).then(_ref2 => {\n      let [metaData, bookData] = _ref2;\n      const newBookData = {\n        coverURL: bookData.archive.urlCache[bookData.cover],\n        title: metaData.title,\n        description: metaData.description,\n        published_date: timeFormatter(new Date(metaData.pubdate)),\n        modified_date: timeFormatter(new Date(metaData.modified_date)),\n        author: metaData.creator,\n        publisher: metaData.publisher,\n        language: metaData.language\n      };\n      onBookInfoChange && onBookInfoChange(newBookData);\n    }).catch(error => {\n      throw `${error.stack} \\n\\n Message : Epub parsing failed.`;\n    });\n  }, [book]);\n  /* eslint-enable */\n\n  /** Set viewer Styles/Options */\n  useEffect(() => {\n    viewerStyle && setBookStyle(v => ({\n      ...v,\n      ...viewerStyle\n    }));\n    viewerOption && setBookOption(v => ({\n      ...v,\n      ...viewerOption\n    }));\n  }, [viewerStyle, viewerOption]);\n\n  /** Apply viewer Styles/Options */\n  useEffect(() => {\n    if (!rendition) return;\n    onResize();\n    const newStyle = {\n      ...viewerDefaultStyles,\n      body: {\n        'padding-top': '0px !important',\n        'padding-bottom': '0px !important',\n        'font-size': `${bookStyle.fontSize}px !important`\n      },\n      p: {\n        'font-size': `${bookStyle.fontSize}px !important`,\n        'line-height': `${bookStyle.lineHeight} !important`\n      }\n    };\n    rendition.flow(bookOption.flow);\n    rendition.spread(bookOption.spread);\n    if (bookStyle.fontFamily !== 'Origin') {\n      Object.assign(newStyle.body, {\n        'font-family': `${bookStyle.fontFamily} !important`\n      });\n    }\n    if (bookOption.flow === 'scrolled-doc') {\n      // Scroll type\n      Object.assign(newStyle.body, {\n        margin: 'auto !important'\n      });\n    } else if (bookOption.spread === 'auto') {\n      // View 2 pages\n      Object.assign(newStyle.body, {});\n    } else {\n      // View 1 page\n      Object.assign(newStyle.body, {});\n    }\n    if (!!viewerStyleURL) {\n      rendition.themes.registerUrl('main', viewerStyleURL);\n    }\n    rendition.themes.register('default', newStyle);\n    rendition.themes.select('main');\n  }, [rendition, bookStyle.fontFamily, bookStyle.fontSize, bookStyle.lineHeight, viewerStyleURL, bookOption, onResize]);\n\n  /** Emit screen resizing event */\n  useEffect(() => {\n    window.addEventListener('resize', onResize);\n    return () => window.removeEventListener('resize', onResize);\n  }, [onResize]);\n\n  /** Emit selection event */\n  useEffect(() => {\n    if (!rendition) return;\n    rendition.on('mouseup', onSelected);\n    return () => rendition.off('mouseup', onSelected);\n  }, [rendition, onSelected]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(EpubViewer, {\n      url: url,\n      style: layoutStyle,\n      bookChanged: bookChanged,\n      rendtionChanged: rendtionChanged,\n      tocChanged: onTocChange,\n      pageChanged: onPageChange,\n      selectionChanged: selectionChanged,\n      loadingView: loadingView || /*#__PURE__*/_jsxDEV(LoadingView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 37\n      }, this),\n      ref: ref\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n_s(ReactViewer, \"dkXwc+cEmWyr2GVcXolpiYNJWzU=\");\n_c = ReactViewer;\nexport default _c2 = /*#__PURE__*/React.forwardRef(ReactViewer);\nvar _c, _c2;\n$RefreshReg$(_c, \"ReactViewer\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","EpubViewer","LoadingView","debounce","timeFormatter","viewerDefaultStyles","ReactViewer","ref","url","viewerLayout","viewerStyle","viewerStyleURL","viewerOption","onBookInfoChange","onPageChange","onTocChange","onSelection","loadingView","book","setBook","rendition","setRendition","layoutStyle","setLayoutStyle","bookStyle","setBookStyle","fontFamily","fontSize","lineHeight","marginHorizontal","marginVertical","bookOption","setBookOption","flow","resizeOnOrientationChange","spread","currentSelection","cfiRange","contents","bookChanged","rendtionChanged","selectionChanged","current","onResize","viewerLayout_","MIN_VIEWER_WIDTH","MIN_VIEWER_HEIGHT","VIEWER_HEADER_HEIGHT","VIEWER_FOOTER_HEIGHT","VIEWER_SIDEMENU_WIDTH","innerWidth","win_w","innerHeight","win_h","window","componentHeight","w","h","layout","width","height","marginTop","marginBottom","resize","onSelected","iframe","querySelector","iframeWin","contentWindow","selection_","getSelection","selectionText","toString","Promise","resolve","setTimeout","Error","all","loaded","metadata","opened","then","metaData","bookData","newBookData","coverURL","archive","urlCache","cover","title","description","published_date","Date","pubdate","modified_date","author","creator","publisher","language","catch","error","stack","v","newStyle","body","p","Object","assign","margin","themes","registerUrl","register","select","addEventListener","removeEventListener","on","off","forwardRef"],"sources":["/home/parallels/Downloads/react-epub-viewer-demo/src/react-viewer/modules/reactViewer/ReactViewer.tsx"],"sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useRef,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { Book, Rendition, Contents } from 'epubjs';\n// modules\nimport EpubViewer from '../../modules/epubViewer/EpubViewer';\n// components\nimport LoadingView from 'LoadingView';\n// utils\nimport { debounce, timeFormatter } from 'lib/utils/commonUtil';\n// styles\nimport viewerDefaultStyles from '../../modules/reactViewer/viewerStyle';\n// types\nimport { ReactViewerProps, ViewerRef } from 'types';\nimport BookType, { BookStyle, BookOption } from 'types/book';\n\n/**\n * Epub React Viewer Module\n * @class\n * @param props\n * @param props.url Epub file path\n * @param props.viewerLayout Viewer layout\n * @param props.viewerStyle Viewer style\n * @param props.viewerStyleURL Viwer style - CSS URL\n * @param props.viewerOption Viewer option\n * @param props.onBookInfoChange Run when book information changed\n * @param props.onPageChange Run when page changed\n * @param props.onTocChange Run when toc changed\n * @param props.onSelection Run when selected\n * @param props.loadingView Loading component\n * @param ref Viewer ref\n */\nconst ReactViewer = (\n  {\n    url,\n    viewerLayout,\n    viewerStyle,\n    viewerStyleURL,\n    viewerOption,\n    onBookInfoChange,\n    onPageChange,\n    onTocChange,\n    onSelection,\n    loadingView,\n  }: ReactViewerProps,\n  ref: React.RefObject<ViewerRef> | any,\n) => {\n  // TODO Fix the ref type correctly instead 'any' type.\n  const [book, setBook] = useState<Book | null>(null);\n\n  const [rendition, setRendition] = useState<Rendition | null>(null);\n\n  const [layoutStyle, setLayoutStyle] = useState<{ [key: string]: any }>({});\n\n  const [bookStyle, setBookStyle] = useState<BookStyle>({\n    fontFamily: 'Origin',\n    fontSize: 16,\n    lineHeight: 1.4,\n    marginHorizontal: 0,\n    marginVertical: 0,\n  });\n\n  const [bookOption, setBookOption] = useState<BookOption>({\n    flow: 'paginated',\n    resizeOnOrientationChange: true,\n    spread: 'auto',\n  });\n\n  const currentSelection = useRef<{\n    cfiRange: string;\n    contents: Contents | null;\n  }>({\n    cfiRange: '',\n    contents: null,\n  });\n\n  /**\n   * Run book changed\n   * @method\n   * @param book Epub Book\n   */\n  const bookChanged = (book: Book) => setBook(book);\n\n  /**\n   * Run rendition changed\n   * @method\n   * @param rendition Epub Rendition\n   */\n  const rendtionChanged = (rendition: Rendition) => setRendition(rendition);\n\n  /**\n   * Run selection changed [Debounce]\n   * @method\n   * @param cfiRange CFIRange\n   * @param contents Selection Epub Contents\n   */\n  const selectionChanged = (cfiRange: string, contents: Contents) => {\n    currentSelection.current = { cfiRange, contents };\n  };\n\n  /**\n   * Viewer resizing function\n   * @method\n   */\n  const onResize = useMemo(\n    () =>\n      debounce(250, () => {\n        if (!rendition) return;\n\n        const viewerLayout_ = viewerLayout || {\n          MIN_VIEWER_WIDTH: 600,\n          MIN_VIEWER_HEIGHT: 300,\n          VIEWER_HEADER_HEIGHT: 0,\n          VIEWER_FOOTER_HEIGHT: 0,\n          VIEWER_SIDEMENU_WIDTH: 0,\n        };\n\n        const { innerWidth: win_w, innerHeight: win_h } = window;\n        const componentHeight =\n          viewerLayout_.VIEWER_HEADER_HEIGHT +\n          viewerLayout_.VIEWER_FOOTER_HEIGHT;\n        const w =\n          win_w -\n          ~~(\n            ((win_w - viewerLayout_.MIN_VIEWER_WIDTH) / 100) *\n            bookStyle.marginHorizontal\n          );\n        const h =\n          bookOption.flow === 'scrolled-doc'\n            ? win_h - componentHeight\n            : win_h -\n              componentHeight -\n              ~~(\n                ((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) /\n                  100) *\n                bookStyle.marginVertical\n              );\n        const marginVertical =\n          bookOption.flow === 'scrolled-doc'\n            ? ''\n            : `${\n                ~~(\n                  ((win_h - componentHeight - viewerLayout_.MIN_VIEWER_HEIGHT) /\n                    100) *\n                  bookStyle.marginVertical\n                ) / 2\n              }px`;\n\n        setLayoutStyle(layout => {\n          if (\n            layout.width !== w ||\n            layout.height !== h ||\n            layout.marginTop !== marginVertical\n          ) {\n            return {\n              ...layout,\n              width: w,\n              height: h,\n              marginTop: marginVertical,\n              marginBottom: marginVertical,\n            };\n          }\n          return layout;\n        });\n\n        try {\n          rendition.resize(w, h);\n        } catch {}\n      }),\n    [\n      rendition,\n      viewerLayout,\n      bookStyle.marginHorizontal,\n      bookStyle.marginVertical,\n      bookOption.flow,\n    ],\n  );\n\n  /**\n   * Selection Event, run when run mouseup event\n   * @method <br/>\n   * - Fire after the Epubjs selected event. [about 300ms]\n   */\n  const onSelected = useCallback(async () => {\n    if (!ref.current) return;\n\n    const iframe = ref.current.querySelector('iframe');\n    if (!iframe) return;\n\n    const iframeWin = iframe.contentWindow;\n    if (!iframeWin) return;\n\n    const selection_ = iframeWin.getSelection();\n    if (!selection_) return;\n\n    const selectionText = selection_.toString();\n    if (selectionText === '') return;\n\n    const cfiRange: string = await new Promise(resolve =>\n      setTimeout(() => resolve(currentSelection.current.cfiRange), 350),\n    );\n    if (!cfiRange) return;\n\n    const contents = currentSelection.current.contents;\n    if (!contents) return;\n\n    onSelection && onSelection(cfiRange, contents);\n  }, [ref, onSelection]);\n\n  /** Ref checker */\n  useEffect(() => {\n    if (!ref) {\n      throw new Error(\n        '[React-Epub-Viewer] Put a ref argument that has a ViewerRef type.',\n      );\n    }\n  }, [ref]);\n\n  /** Epub parsing */\n  // TODO Fix the infinite re-rendering issue, when inlcude `onBookInfoChange` to dependencies array.\n  /* eslint-disable */\n  useEffect(() => {\n    if (!book) return;\n\n    Promise.all([book.loaded.metadata, book.opened])\n      .then(([metaData, bookData]: any[]) => {\n        const newBookData: BookType = {\n          coverURL: bookData.archive.urlCache[bookData.cover],\n          title: metaData.title,\n          description: metaData.description,\n          published_date: timeFormatter(new Date(metaData.pubdate)),\n          modified_date: timeFormatter(new Date(metaData.modified_date)),\n          author: metaData.creator,\n          publisher: metaData.publisher,\n          language: metaData.language,\n        };\n\n        onBookInfoChange && onBookInfoChange(newBookData);\n      })\n      .catch(error => {\n        throw `${error.stack} \\n\\n Message : Epub parsing failed.`;\n      });\n  }, [book]);\n  /* eslint-enable */\n\n  /** Set viewer Styles/Options */\n  useEffect(() => {\n    viewerStyle && setBookStyle(v => ({ ...v, ...viewerStyle }));\n    viewerOption && setBookOption(v => ({ ...v, ...viewerOption }));\n  }, [viewerStyle, viewerOption]);\n\n  /** Apply viewer Styles/Options */\n  useEffect(() => {\n    if (!rendition) return;\n\n    onResize();\n\n    const newStyle = {\n      ...viewerDefaultStyles,\n      body: {\n        'padding-top': '0px !important',\n        'padding-bottom': '0px !important',\n        'font-size': `${bookStyle.fontSize}px !important`,\n      },\n      p: {\n        'font-size': `${bookStyle.fontSize}px !important`,\n        'line-height': `${bookStyle.lineHeight} !important`,\n      },\n    };\n\n    rendition.flow(bookOption.flow);\n    rendition.spread(bookOption.spread);\n\n    if (bookStyle.fontFamily !== 'Origin') {\n      Object.assign(newStyle.body, {\n        'font-family': `${bookStyle.fontFamily} !important`,\n      });\n    }\n\n    if (bookOption.flow === 'scrolled-doc') {\n      // Scroll type\n      Object.assign(newStyle.body, {\n        margin: 'auto !important',\n      });\n    } else if (bookOption.spread === 'auto') {\n      // View 2 pages\n      Object.assign(newStyle.body, {});\n    } else {\n      // View 1 page\n      Object.assign(newStyle.body, {});\n    }\n\n    if (!!viewerStyleURL) {\n      rendition.themes.registerUrl('main', viewerStyleURL);\n    }\n\n    rendition.themes.register('default', newStyle);\n\n    rendition.themes.select('main');\n  }, [\n    rendition,\n    bookStyle.fontFamily,\n    bookStyle.fontSize,\n    bookStyle.lineHeight,\n    viewerStyleURL,\n    bookOption,\n    onResize,\n  ]);\n\n  /** Emit screen resizing event */\n  useEffect(() => {\n    window.addEventListener('resize', onResize);\n    return () => window.removeEventListener('resize', onResize);\n  }, [onResize]);\n\n  /** Emit selection event */\n  useEffect(() => {\n    if (!rendition) return;\n    rendition.on('mouseup', onSelected);\n    return () => rendition.off('mouseup', onSelected);\n  }, [rendition, onSelected]);\n\n\n\n  return (\n    <>\n      <EpubViewer\n        url={url}\n        style={layoutStyle}\n        bookChanged={bookChanged}\n        rendtionChanged={rendtionChanged}\n        tocChanged={onTocChange}\n        pageChanged={onPageChange}\n        selectionChanged={selectionChanged}\n        loadingView={loadingView || <LoadingView />}\n        ref={ref}\n      />\n    </>\n  );\n};\n\nexport default React.forwardRef(ReactViewer);\n"],"mappings":";;AAAA,OAAOA,KAAK,IACVC,QAAQ,EACRC,SAAS,EACTC,MAAM,EACNC,WAAW,EACXC,OAAO,QACF,OAAO;AAEd;AACA,OAAOC,UAAU,MAAM,qCAAqC;AAC5D;AACA,OAAOC,WAAW,MAAM,aAAa;AACrC;AACA,SAASC,QAAQ,EAAEC,aAAa,QAAQ,sBAAsB;AAC9D;AACA,OAAOC,mBAAmB,MAAM,uCAAuC;AACvE;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,WAAW,GAAG,OAalBC,GAAqC,KAClC;EAAA;EAAA,IAbH;IACEC,GAAG;IACHC,YAAY;IACZC,WAAW;IACXC,cAAc;IACdC,YAAY;IACZC,gBAAgB;IAChBC,YAAY;IACZC,WAAW;IACXC,WAAW;IACXC;EACgB,CAAC;EAGnB;EACA,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGvB,QAAQ,CAAc,IAAI,CAAC;EAEnD,MAAM,CAACwB,SAAS,EAAEC,YAAY,CAAC,GAAGzB,QAAQ,CAAmB,IAAI,CAAC;EAElE,MAAM,CAAC0B,WAAW,EAAEC,cAAc,CAAC,GAAG3B,QAAQ,CAAyB,CAAC,CAAC,CAAC;EAE1E,MAAM,CAAC4B,SAAS,EAAEC,YAAY,CAAC,GAAG7B,QAAQ,CAAY;IACpD8B,UAAU,EAAE,QAAQ;IACpBC,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,GAAG;IACfC,gBAAgB,EAAE,CAAC;IACnBC,cAAc,EAAE;EAClB,CAAC,CAAC;EAEF,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGpC,QAAQ,CAAa;IACvDqC,IAAI,EAAE,WAAW;IACjBC,yBAAyB,EAAE,IAAI;IAC/BC,MAAM,EAAE;EACV,CAAC,CAAC;EAEF,MAAMC,gBAAgB,GAAGtC,MAAM,CAG5B;IACDuC,QAAQ,EAAE,EAAE;IACZC,QAAQ,EAAE;EACZ,CAAC,CAAC;;EAEF;AACF;AACA;AACA;AACA;EACE,MAAMC,WAAW,GAAIrB,IAAU,IAAKC,OAAO,CAACD,IAAI,CAAC;;EAEjD;AACF;AACA;AACA;AACA;EACE,MAAMsB,eAAe,GAAIpB,SAAoB,IAAKC,YAAY,CAACD,SAAS,CAAC;;EAEzE;AACF;AACA;AACA;AACA;AACA;EACE,MAAMqB,gBAAgB,GAAG,CAACJ,QAAgB,EAAEC,QAAkB,KAAK;IACjEF,gBAAgB,CAACM,OAAO,GAAG;MAAEL,QAAQ;MAAEC;IAAS,CAAC;EACnD,CAAC;;EAED;AACF;AACA;AACA;EACE,MAAMK,QAAQ,GAAG3C,OAAO,CACtB,MACEG,QAAQ,CAAC,GAAG,EAAE,MAAM;IAClB,IAAI,CAACiB,SAAS,EAAE;IAEhB,MAAMwB,aAAa,GAAGnC,YAAY,IAAI;MACpCoC,gBAAgB,EAAE,GAAG;MACrBC,iBAAiB,EAAE,GAAG;MACtBC,oBAAoB,EAAE,CAAC;MACvBC,oBAAoB,EAAE,CAAC;MACvBC,qBAAqB,EAAE;IACzB,CAAC;IAED,MAAM;MAAEC,UAAU,EAAEC,KAAK;MAAEC,WAAW,EAAEC;IAAM,CAAC,GAAGC,MAAM;IACxD,MAAMC,eAAe,GACnBX,aAAa,CAACG,oBAAoB,GAClCH,aAAa,CAACI,oBAAoB;IACpC,MAAMQ,CAAC,GACLL,KAAK,GACL,CAAC,EACE,CAACA,KAAK,GAAGP,aAAa,CAACC,gBAAgB,IAAI,GAAG,GAC/CrB,SAAS,CAACK,gBAAgB,CAC3B;IACH,MAAM4B,CAAC,GACL1B,UAAU,CAACE,IAAI,KAAK,cAAc,GAC9BoB,KAAK,GAAGE,eAAe,GACvBF,KAAK,GACLE,eAAe,GACf,CAAC,EACE,CAACF,KAAK,GAAGE,eAAe,GAAGX,aAAa,CAACE,iBAAiB,IACzD,GAAG,GACLtB,SAAS,CAACM,cAAc,CACzB;IACP,MAAMA,cAAc,GAClBC,UAAU,CAACE,IAAI,KAAK,cAAc,GAC9B,EAAE,GACD,GACC,CAAC,EACE,CAACoB,KAAK,GAAGE,eAAe,GAAGX,aAAa,CAACE,iBAAiB,IACzD,GAAG,GACLtB,SAAS,CAACM,cAAc,CACzB,GAAG,CACL,IAAG;IAEVP,cAAc,CAACmC,MAAM,IAAI;MACvB,IACEA,MAAM,CAACC,KAAK,KAAKH,CAAC,IAClBE,MAAM,CAACE,MAAM,KAAKH,CAAC,IACnBC,MAAM,CAACG,SAAS,KAAK/B,cAAc,EACnC;QACA,OAAO;UACL,GAAG4B,MAAM;UACTC,KAAK,EAAEH,CAAC;UACRI,MAAM,EAAEH,CAAC;UACTI,SAAS,EAAE/B,cAAc;UACzBgC,YAAY,EAAEhC;QAChB,CAAC;MACH;MACA,OAAO4B,MAAM;IACf,CAAC,CAAC;IAEF,IAAI;MACFtC,SAAS,CAAC2C,MAAM,CAACP,CAAC,EAAEC,CAAC,CAAC;IACxB,CAAC,CAAC,MAAM,CAAC;EACX,CAAC,CAAC,EACJ,CACErC,SAAS,EACTX,YAAY,EACZe,SAAS,CAACK,gBAAgB,EAC1BL,SAAS,CAACM,cAAc,EACxBC,UAAU,CAACE,IAAI,CAChB,CACF;;EAED;AACF;AACA;AACA;AACA;EACE,MAAM+B,UAAU,GAAGjE,WAAW,CAAC,YAAY;IACzC,IAAI,CAACQ,GAAG,CAACmC,OAAO,EAAE;IAElB,MAAMuB,MAAM,GAAG1D,GAAG,CAACmC,OAAO,CAACwB,aAAa,CAAC,QAAQ,CAAC;IAClD,IAAI,CAACD,MAAM,EAAE;IAEb,MAAME,SAAS,GAAGF,MAAM,CAACG,aAAa;IACtC,IAAI,CAACD,SAAS,EAAE;IAEhB,MAAME,UAAU,GAAGF,SAAS,CAACG,YAAY,EAAE;IAC3C,IAAI,CAACD,UAAU,EAAE;IAEjB,MAAME,aAAa,GAAGF,UAAU,CAACG,QAAQ,EAAE;IAC3C,IAAID,aAAa,KAAK,EAAE,EAAE;IAE1B,MAAMlC,QAAgB,GAAG,MAAM,IAAIoC,OAAO,CAACC,OAAO,IAChDC,UAAU,CAAC,MAAMD,OAAO,CAACtC,gBAAgB,CAACM,OAAO,CAACL,QAAQ,CAAC,EAAE,GAAG,CAAC,CAClE;IACD,IAAI,CAACA,QAAQ,EAAE;IAEf,MAAMC,QAAQ,GAAGF,gBAAgB,CAACM,OAAO,CAACJ,QAAQ;IAClD,IAAI,CAACA,QAAQ,EAAE;IAEftB,WAAW,IAAIA,WAAW,CAACqB,QAAQ,EAAEC,QAAQ,CAAC;EAChD,CAAC,EAAE,CAAC/B,GAAG,EAAES,WAAW,CAAC,CAAC;;EAEtB;EACAnB,SAAS,CAAC,MAAM;IACd,IAAI,CAACU,GAAG,EAAE;MACR,MAAM,IAAIqE,KAAK,CACb,mEAAmE,CACpE;IACH;EACF,CAAC,EAAE,CAACrE,GAAG,CAAC,CAAC;;EAET;EACA;EACA;EACAV,SAAS,CAAC,MAAM;IACd,IAAI,CAACqB,IAAI,EAAE;IAEXuD,OAAO,CAACI,GAAG,CAAC,CAAC3D,IAAI,CAAC4D,MAAM,CAACC,QAAQ,EAAE7D,IAAI,CAAC8D,MAAM,CAAC,CAAC,CAC7CC,IAAI,CAAC,SAAiC;MAAA,IAAhC,CAACC,QAAQ,EAAEC,QAAQ,CAAQ;MAChC,MAAMC,WAAqB,GAAG;QAC5BC,QAAQ,EAAEF,QAAQ,CAACG,OAAO,CAACC,QAAQ,CAACJ,QAAQ,CAACK,KAAK,CAAC;QACnDC,KAAK,EAAEP,QAAQ,CAACO,KAAK;QACrBC,WAAW,EAAER,QAAQ,CAACQ,WAAW;QACjCC,cAAc,EAAEvF,aAAa,CAAC,IAAIwF,IAAI,CAACV,QAAQ,CAACW,OAAO,CAAC,CAAC;QACzDC,aAAa,EAAE1F,aAAa,CAAC,IAAIwF,IAAI,CAACV,QAAQ,CAACY,aAAa,CAAC,CAAC;QAC9DC,MAAM,EAAEb,QAAQ,CAACc,OAAO;QACxBC,SAAS,EAAEf,QAAQ,CAACe,SAAS;QAC7BC,QAAQ,EAAEhB,QAAQ,CAACgB;MACrB,CAAC;MAEDrF,gBAAgB,IAAIA,gBAAgB,CAACuE,WAAW,CAAC;IACnD,CAAC,CAAC,CACDe,KAAK,CAACC,KAAK,IAAI;MACd,MAAO,GAAEA,KAAK,CAACC,KAAM,sCAAqC;IAC5D,CAAC,CAAC;EACN,CAAC,EAAE,CAACnF,IAAI,CAAC,CAAC;EACV;;EAEA;EACArB,SAAS,CAAC,MAAM;IACda,WAAW,IAAIe,YAAY,CAAC6E,CAAC,KAAK;MAAE,GAAGA,CAAC;MAAE,GAAG5F;IAAY,CAAC,CAAC,CAAC;IAC5DE,YAAY,IAAIoB,aAAa,CAACsE,CAAC,KAAK;MAAE,GAAGA,CAAC;MAAE,GAAG1F;IAAa,CAAC,CAAC,CAAC;EACjE,CAAC,EAAE,CAACF,WAAW,EAAEE,YAAY,CAAC,CAAC;;EAE/B;EACAf,SAAS,CAAC,MAAM;IACd,IAAI,CAACuB,SAAS,EAAE;IAEhBuB,QAAQ,EAAE;IAEV,MAAM4D,QAAQ,GAAG;MACf,GAAGlG,mBAAmB;MACtBmG,IAAI,EAAE;QACJ,aAAa,EAAE,gBAAgB;QAC/B,gBAAgB,EAAE,gBAAgB;QAClC,WAAW,EAAG,GAAEhF,SAAS,CAACG,QAAS;MACrC,CAAC;MACD8E,CAAC,EAAE;QACD,WAAW,EAAG,GAAEjF,SAAS,CAACG,QAAS,eAAc;QACjD,aAAa,EAAG,GAAEH,SAAS,CAACI,UAAW;MACzC;IACF,CAAC;IAEDR,SAAS,CAACa,IAAI,CAACF,UAAU,CAACE,IAAI,CAAC;IAC/Bb,SAAS,CAACe,MAAM,CAACJ,UAAU,CAACI,MAAM,CAAC;IAEnC,IAAIX,SAAS,CAACE,UAAU,KAAK,QAAQ,EAAE;MACrCgF,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACC,IAAI,EAAE;QAC3B,aAAa,EAAG,GAAEhF,SAAS,CAACE,UAAW;MACzC,CAAC,CAAC;IACJ;IAEA,IAAIK,UAAU,CAACE,IAAI,KAAK,cAAc,EAAE;MACtC;MACAyE,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACC,IAAI,EAAE;QAC3BI,MAAM,EAAE;MACV,CAAC,CAAC;IACJ,CAAC,MAAM,IAAI7E,UAAU,CAACI,MAAM,KAAK,MAAM,EAAE;MACvC;MACAuE,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACC,IAAI,EAAE,CAAC,CAAC,CAAC;IAClC,CAAC,MAAM;MACL;MACAE,MAAM,CAACC,MAAM,CAACJ,QAAQ,CAACC,IAAI,EAAE,CAAC,CAAC,CAAC;IAClC;IAEA,IAAI,CAAC,CAAC7F,cAAc,EAAE;MACpBS,SAAS,CAACyF,MAAM,CAACC,WAAW,CAAC,MAAM,EAAEnG,cAAc,CAAC;IACtD;IAEAS,SAAS,CAACyF,MAAM,CAACE,QAAQ,CAAC,SAAS,EAAER,QAAQ,CAAC;IAE9CnF,SAAS,CAACyF,MAAM,CAACG,MAAM,CAAC,MAAM,CAAC;EACjC,CAAC,EAAE,CACD5F,SAAS,EACTI,SAAS,CAACE,UAAU,EACpBF,SAAS,CAACG,QAAQ,EAClBH,SAAS,CAACI,UAAU,EACpBjB,cAAc,EACdoB,UAAU,EACVY,QAAQ,CACT,CAAC;;EAEF;EACA9C,SAAS,CAAC,MAAM;IACdyD,MAAM,CAAC2D,gBAAgB,CAAC,QAAQ,EAAEtE,QAAQ,CAAC;IAC3C,OAAO,MAAMW,MAAM,CAAC4D,mBAAmB,CAAC,QAAQ,EAAEvE,QAAQ,CAAC;EAC7D,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;;EAEd;EACA9C,SAAS,CAAC,MAAM;IACd,IAAI,CAACuB,SAAS,EAAE;IAChBA,SAAS,CAAC+F,EAAE,CAAC,SAAS,EAAEnD,UAAU,CAAC;IACnC,OAAO,MAAM5C,SAAS,CAACgG,GAAG,CAAC,SAAS,EAAEpD,UAAU,CAAC;EACnD,CAAC,EAAE,CAAC5C,SAAS,EAAE4C,UAAU,CAAC,CAAC;EAI3B,oBACE;IAAA,uBACE,QAAC,UAAU;MACT,GAAG,EAAExD,GAAI;MACT,KAAK,EAAEc,WAAY;MACnB,WAAW,EAAEiB,WAAY;MACzB,eAAe,EAAEC,eAAgB;MACjC,UAAU,EAAEzB,WAAY;MACxB,WAAW,EAAED,YAAa;MAC1B,gBAAgB,EAAE2B,gBAAiB;MACnC,WAAW,EAAExB,WAAW,iBAAI,QAAC,WAAW;QAAA;QAAA;QAAA;MAAA,QAAI;MAC5C,GAAG,EAAEV;IAAI;MAAA;MAAA;MAAA;IAAA;EACT,iBACD;AAEP,CAAC;AAAC,GAnTID,WAAW;AAAA,KAAXA,WAAW;AAqTjB,kCAAeX,KAAK,CAAC0H,UAAU,CAAC/G,WAAW,CAAC;AAAC;AAAA;AAAA"},"metadata":{},"sourceType":"module"}