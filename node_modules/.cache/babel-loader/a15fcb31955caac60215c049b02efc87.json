{"ast":null,"code":"import _classCallCheck from \"/home/parallels/Downloads/read/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/parallels/Downloads/read/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n/**\n * Hooks allow for injecting functions that must all complete in order before finishing\n * They will execute in parallel but all must finish before continuing\n * Functions may return a promise if they are async.\n * @param {any} context scope of this\n * @example this.content = new EPUBJS.Hook(this);\n */\nvar Hook = /*#__PURE__*/function () {\n  function Hook(context) {\n    _classCallCheck(this, Hook);\n    this.context = context || this;\n    this.hooks = [];\n  }\n\n  /**\n   * Adds a function to be run before a hook completes\n   * @example this.content.register(function(){...});\n   */\n  _createClass(Hook, [{\n    key: \"register\",\n    value: function register() {\n      for (var i = 0; i < arguments.length; ++i) {\n        if (typeof arguments[i] === \"function\") {\n          this.hooks.push(arguments[i]);\n        } else {\n          // unpack array\n          for (var j = 0; j < arguments[i].length; ++j) {\n            this.hooks.push(arguments[i][j]);\n          }\n        }\n      }\n    }\n\n    /**\n     * Removes a function\n     * @example this.content.deregister(function(){...});\n     */\n  }, {\n    key: \"deregister\",\n    value: function deregister(func) {\n      var hook;\n      for (var i = 0; i < this.hooks.length; i++) {\n        hook = this.hooks[i];\n        if (hook === func) {\n          this.hooks.splice(i, 1);\n          break;\n        }\n      }\n    }\n\n    /**\n     * Triggers a hook to run all functions\n     * @example this.content.trigger(args).then(function(){...});\n     */\n  }, {\n    key: \"trigger\",\n    value: function trigger() {\n      var args = arguments;\n      var context = this.context;\n      var promises = [];\n      this.hooks.forEach(function (task) {\n        try {\n          var executing = task.apply(context, args);\n        } catch (err) {\n          console.log(err);\n        }\n        if (executing && typeof executing[\"then\"] === \"function\") {\n          // Task is a function that returns a promise\n          promises.push(executing);\n        }\n        // Otherwise Task resolves immediately, continue\n      });\n\n      return Promise.all(promises);\n    }\n\n    // Adds a function to be run before a hook completes\n  }, {\n    key: \"list\",\n    value: function list() {\n      return this.hooks;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      return this.hooks = [];\n    }\n  }]);\n  return Hook;\n}();\nexport default Hook;","map":{"version":3,"names":["Hook","context","hooks","i","arguments","length","push","j","func","hook","splice","args","promises","forEach","task","executing","apply","err","console","log","Promise","all"],"sources":["/home/parallels/Downloads/read/node_modules/epubjs/src/utils/hook.js"],"sourcesContent":["/**\n * Hooks allow for injecting functions that must all complete in order before finishing\n * They will execute in parallel but all must finish before continuing\n * Functions may return a promise if they are async.\n * @param {any} context scope of this\n * @example this.content = new EPUBJS.Hook(this);\n */\nclass Hook {\n\tconstructor(context){\n\t\tthis.context = context || this;\n\t\tthis.hooks = [];\n\t}\n\n\t/**\n\t * Adds a function to be run before a hook completes\n\t * @example this.content.register(function(){...});\n\t */\n\tregister(){\n\t\tfor(var i = 0; i < arguments.length; ++i) {\n\t\t\tif (typeof arguments[i]  === \"function\") {\n\t\t\t\tthis.hooks.push(arguments[i]);\n\t\t\t} else {\n\t\t\t\t// unpack array\n\t\t\t\tfor(var j = 0; j < arguments[i].length; ++j) {\n\t\t\t\t\tthis.hooks.push(arguments[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes a function\n\t * @example this.content.deregister(function(){...});\n\t */\n\tderegister(func){\n\t\tlet hook;\n\t\tfor (let i = 0; i < this.hooks.length; i++) {\n\t\t\thook = this.hooks[i];\n\t\t\tif (hook === func) {\n\t\t\t\tthis.hooks.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers a hook to run all functions\n\t * @example this.content.trigger(args).then(function(){...});\n\t */\n\ttrigger(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar promises = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\ttry {\n\t\t\t\tvar executing = task.apply(context, args);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t}\n\n\t\t\tif(executing && typeof executing[\"then\"] === \"function\") {\n\t\t\t\t// Task is a function that returns a promise\n\t\t\t\tpromises.push(executing);\n\t\t\t}\n\t\t\t// Otherwise Task resolves immediately, continue\n\t\t});\n\n\n\t\treturn Promise.all(promises);\n\t}\n\n\t// Adds a function to be run before a hook completes\n\tlist(){\n\t\treturn this.hooks;\n\t}\n\n\tclear(){\n\t\treturn this.hooks = [];\n\t}\n}\nexport default Hook;\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AANA,IAOMA,IAAI;EACT,cAAYC,OAAO,EAAC;IAAA;IACnB,IAAI,CAACA,OAAO,GAAGA,OAAO,IAAI,IAAI;IAC9B,IAAI,CAACC,KAAK,GAAG,EAAE;EAChB;;EAEA;AACD;AACA;AACA;EAHC;IAAA;IAAA,OAIA,oBAAU;MACT,KAAI,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGC,SAAS,CAACC,MAAM,EAAE,EAAEF,CAAC,EAAE;QACzC,IAAI,OAAOC,SAAS,CAACD,CAAC,CAAC,KAAM,UAAU,EAAE;UACxC,IAAI,CAACD,KAAK,CAACI,IAAI,CAACF,SAAS,CAACD,CAAC,CAAC,CAAC;QAC9B,CAAC,MAAM;UACN;UACA,KAAI,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,SAAS,CAACD,CAAC,CAAC,CAACE,MAAM,EAAE,EAAEE,CAAC,EAAE;YAC5C,IAAI,CAACL,KAAK,CAACI,IAAI,CAACF,SAAS,CAACD,CAAC,CAAC,CAACI,CAAC,CAAC,CAAC;UACjC;QACD;MACD;IACD;;IAEA;AACD;AACA;AACA;EAHC;IAAA;IAAA,OAIA,oBAAWC,IAAI,EAAC;MACf,IAAIC,IAAI;MACR,KAAK,IAAIN,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAACD,KAAK,CAACG,MAAM,EAAEF,CAAC,EAAE,EAAE;QAC3CM,IAAI,GAAG,IAAI,CAACP,KAAK,CAACC,CAAC,CAAC;QACpB,IAAIM,IAAI,KAAKD,IAAI,EAAE;UAClB,IAAI,CAACN,KAAK,CAACQ,MAAM,CAACP,CAAC,EAAE,CAAC,CAAC;UACvB;QACD;MACD;IACD;;IAEA;AACD;AACA;AACA;EAHC;IAAA;IAAA,OAIA,mBAAS;MACR,IAAIQ,IAAI,GAAGP,SAAS;MACpB,IAAIH,OAAO,GAAG,IAAI,CAACA,OAAO;MAC1B,IAAIW,QAAQ,GAAG,EAAE;MAEjB,IAAI,CAACV,KAAK,CAACW,OAAO,CAAC,UAASC,IAAI,EAAE;QACjC,IAAI;UACH,IAAIC,SAAS,GAAGD,IAAI,CAACE,KAAK,CAACf,OAAO,EAAEU,IAAI,CAAC;QAC1C,CAAC,CAAC,OAAOM,GAAG,EAAE;UACbC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QACjB;QAEA,IAAGF,SAAS,IAAI,OAAOA,SAAS,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;UACxD;UACAH,QAAQ,CAACN,IAAI,CAACS,SAAS,CAAC;QACzB;QACA;MACD,CAAC,CAAC;;MAGF,OAAOK,OAAO,CAACC,GAAG,CAACT,QAAQ,CAAC;IAC7B;;IAEA;EAAA;IAAA;IAAA,OACA,gBAAM;MACL,OAAO,IAAI,CAACV,KAAK;IAClB;EAAC;IAAA;IAAA,OAED,iBAAO;MACN,OAAO,IAAI,CAACA,KAAK,GAAG,EAAE;IACvB;EAAC;EAAA;AAAA;AAEF,eAAeF,IAAI"},"metadata":{},"sourceType":"module"}